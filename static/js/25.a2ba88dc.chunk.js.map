{"version":3,"sources":["config lazy /^/.//.*/-dev/.json$/ groupOptions: {} namespace object","config lazy /^/.//.*/.json$/ groupOptions: {} namespace object","components lazy /^/.//.*$/ groupOptions: {} namespace object","config/index.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","map","webpackAsyncContext","__webpack_require__","o","ids","t","Object","all","slice","_configFile","_components","_serializeComponentDependencies","config","components","length","DAG","Array","i","rowComponent","fill","j","colComponent","parents","includes","name","createDAG","visited","visiting","unvisited","_","hasParents","push","splice","findIndex","index","serializeDAG","getComponent","a","configModule","default","importPromises","forEach","componentEntry","component","elements","registerElementSpecificationEntries","specification","fromEntries","elementName","filter","undefined","mount","librarySpecification","iterator","entries","setupComponent","iteratorResult","done","value","setup","next"],"mappings":"8FAAA,SAASA,EAAyBC,GAGjC,OAAOC,QAAQC,UAAUC,MAAK,WAC7B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBL,EAAM,KAEjD,MADAI,EAAEE,KAAO,mBACHF,KAGRL,EAAyBQ,KAAO,WAAa,MAAO,IACpDR,EAAyBG,QAAUH,EACnCS,EAAOC,QAAUV,EACjBA,EAAyBW,GAAK,K,oBCZ9B,IAAIC,EAAM,CACT,cAAe,CACd,IACA,KAGF,SAASC,EAAoBZ,GAC5B,IAAIa,EAAoBC,EAAEH,EAAKX,GAC9B,OAAOC,QAAQC,UAAUC,MAAK,WAC7B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBL,EAAM,KAEjD,MADAI,EAAEE,KAAO,mBACHF,KAIR,IAAIW,EAAMJ,EAAIX,GAAMU,EAAKK,EAAI,GAC7B,OAAOF,EAAoBT,EAAEW,EAAI,IAAIZ,MAAK,WACzC,OAAOU,EAAoBG,EAAEN,EAAI,MAGnCE,EAAoBL,KAAO,WAC1B,OAAOU,OAAOV,KAAKI,IAEpBC,EAAoBF,GAAK,IACzBF,EAAOC,QAAUG,G,oBCxBjB,IAAID,EAAM,CACT,WAAY,CACX,GACA,EACA,EACA,GAED,YAAa,CACZ,GACA,EACA,EACA,GAED,kBAAmB,CAClB,GACA,EACA,IAED,mBAAoB,CACnB,GACA,EACA,IAED,wBAAyB,CACxB,GACA,EACA,IAED,2BAA4B,CAC3B,GACA,EACA,IAED,gBAAiB,CAChB,GACA,EACA,EACA,IAED,iBAAkB,CACjB,GACA,EACA,EACA,IAED,uBAAwB,CACvB,GACA,EACA,IAED,0BAA2B,CAC1B,GACA,EACA,IAED,sBAAuB,CACtB,GACA,EACA,EACA,IAED,yBAA0B,CACzB,GACA,EACA,EACA,IAED,iBAAkB,CACjB,GACA,EACA,EACA,GAED,oBAAqB,CACpB,GACA,EACA,EACA,GAED,gBAAiB,CAChB,GACA,EACA,EACA,GAED,iBAAkB,CACjB,GACA,EACA,EACA,GAED,2BAA4B,CAC3B,GACA,EACA,GAED,4BAA6B,CAC5B,GACA,EACA,GAED,kCAAmC,CAClC,GACA,EACA,IAED,mCAAoC,CACnC,GACA,EACA,IAED,wCAAyC,CACxC,GACA,EACA,IAED,6CAA8C,CAC7C,GACA,EACA,IAED,4CAA6C,CAC5C,GACA,EACA,IAED,iCAAkC,CACjC,GACA,EACA,GAED,sCAAuC,CACtC,GACA,EACA,IAED,qCAAsC,CACrC,GACA,EACA,GAED,sBAAuB,CACtB,GACA,EACA,EACA,GAED,yBAA0B,CACzB,GACA,EACA,EACA,GAED,oCAAqC,CACpC,GACA,EACA,IAED,oCAAqC,CACpC,GACA,EACA,IAED,mCAAoC,CACnC,GACA,EACA,IAED,mCAAoC,CACnC,GACA,EACA,IAED,SAAU,CACT,GACA,EACA,GAED,UAAW,CACV,GACA,EACA,GAED,eAAgB,CACf,GACA,EACA,GAED,kBAAmB,CAClB,GACA,EACA,GAED,cAAe,CACd,GACA,EACA,GAED,eAAgB,CACf,GACA,EACA,GAED,yBAA0B,CACzB,GACA,EACA,GAED,0BAA2B,CAC1B,GACA,EACA,GAED,+BAAgC,CAC/B,GACA,EACA,GAED,oCAAqC,CACpC,GACA,EACA,IAED,mCAAoC,CACnC,GACA,EACA,GAED,oBAAqB,CACpB,GACA,EACA,GAED,uBAAwB,CACvB,GACA,EACA,GAED,kCAAmC,CAClC,GACA,EACA,IAED,gCAAiC,CAChC,GACA,EACA,IAED,iCAAkC,CACjC,GACA,EACA,IAED,YAAa,CACZ,GACA,EACA,EACA,EACA,IAED,aAAc,CACb,GACA,EACA,EACA,EACA,IAED,2BAA4B,CAC3B,GACA,EACA,IAED,8BAA+B,CAC9B,GACA,EACA,IAED,0BAA2B,CAC1B,GACA,EACA,EACA,IAED,6BAA8B,CAC7B,GACA,EACA,EACA,IAED,uBAAwB,CACvB,GACA,EACA,IAED,0BAA2B,CAC1B,GACA,EACA,IAED,kBAAmB,CAClB,GACA,EACA,EACA,EACA,IAED,qBAAsB,CACrB,GACA,EACA,EACA,EACA,IAED,oBAAqB,CACpB,GACA,EACA,EACA,GAED,uBAAwB,CACvB,GACA,EACA,EACA,GAED,iBAAkB,CACjB,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","file":"static/js/25.a2ba88dc.chunk.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 117;","var map = {\n\t\"./base.json\": [\n\t\t120,\n\t\t39\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 118;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./editor\": [\n\t\t67,\n\t\t9,\n\t\t1,\n\t\t3\n\t],\n\t\"./editor/\": [\n\t\t67,\n\t\t9,\n\t\t1,\n\t\t3\n\t],\n\t\"./editor/@types\": [\n\t\t65,\n\t\t9,\n\t\t13\n\t],\n\t\"./editor/@types/\": [\n\t\t65,\n\t\t9,\n\t\t13\n\t],\n\t\"./editor/@types/index\": [\n\t\t65,\n\t\t9,\n\t\t13\n\t],\n\t\"./editor/@types/index.ts\": [\n\t\t65,\n\t\t9,\n\t\t13\n\t],\n\t\"./editor/core\": [\n\t\t24,\n\t\t9,\n\t\t1,\n\t\t12\n\t],\n\t\"./editor/core/\": [\n\t\t24,\n\t\t9,\n\t\t1,\n\t\t12\n\t],\n\t\"./editor/core/errors\": [\n\t\t27,\n\t\t9,\n\t\t15\n\t],\n\t\"./editor/core/errors.ts\": [\n\t\t27,\n\t\t9,\n\t\t15\n\t],\n\t\"./editor/core/index\": [\n\t\t24,\n\t\t9,\n\t\t1,\n\t\t12\n\t],\n\t\"./editor/core/index.ts\": [\n\t\t24,\n\t\t9,\n\t\t1,\n\t\t12\n\t],\n\t\"./editor/index\": [\n\t\t67,\n\t\t9,\n\t\t1,\n\t\t3\n\t],\n\t\"./editor/index.ts\": [\n\t\t67,\n\t\t9,\n\t\t1,\n\t\t3\n\t],\n\t\"./editor/view\": [\n\t\t56,\n\t\t9,\n\t\t1,\n\t\t4\n\t],\n\t\"./editor/view/\": [\n\t\t56,\n\t\t9,\n\t\t1,\n\t\t4\n\t],\n\t\"./editor/view/components\": [\n\t\t14,\n\t\t9,\n\t\t9\n\t],\n\t\"./editor/view/components/\": [\n\t\t14,\n\t\t9,\n\t\t9\n\t],\n\t\"./editor/view/components/button\": [\n\t\t28,\n\t\t9,\n\t\t10\n\t],\n\t\"./editor/view/components/button/\": [\n\t\t28,\n\t\t9,\n\t\t10\n\t],\n\t\"./editor/view/components/button/index\": [\n\t\t28,\n\t\t9,\n\t\t10\n\t],\n\t\"./editor/view/components/button/index.scss\": [\n\t\t42,\n\t\t7,\n\t\t26\n\t],\n\t\"./editor/view/components/button/index.tsx\": [\n\t\t28,\n\t\t9,\n\t\t10\n\t],\n\t\"./editor/view/components/index\": [\n\t\t14,\n\t\t9,\n\t\t9\n\t],\n\t\"./editor/view/components/index.scss\": [\n\t\t40,\n\t\t7,\n\t\t27\n\t],\n\t\"./editor/view/components/index.tsx\": [\n\t\t14,\n\t\t9,\n\t\t9\n\t],\n\t\"./editor/view/index\": [\n\t\t56,\n\t\t9,\n\t\t1,\n\t\t4\n\t],\n\t\"./editor/view/index.ts\": [\n\t\t56,\n\t\t9,\n\t\t1,\n\t\t4\n\t],\n\t\"./editor/view/resources/build.svg\": [\n\t\t39,\n\t\t9,\n\t\t31\n\t],\n\t\"./editor/view/resources/close.svg\": [\n\t\t21,\n\t\t9,\n\t\t32\n\t],\n\t\"./editor/view/resources/code.svg\": [\n\t\t41,\n\t\t9,\n\t\t33\n\t],\n\t\"./editor/view/resources/help.svg\": [\n\t\t38,\n\t\t9,\n\t\t34\n\t],\n\t\"./menu\": [\n\t\t68,\n\t\t9,\n\t\t5\n\t],\n\t\"./menu/\": [\n\t\t68,\n\t\t9,\n\t\t5\n\t],\n\t\"./menu/index\": [\n\t\t68,\n\t\t9,\n\t\t5\n\t],\n\t\"./menu/index.ts\": [\n\t\t68,\n\t\t9,\n\t\t5\n\t],\n\t\"./menu/view\": [\n\t\t57,\n\t\t9,\n\t\t6\n\t],\n\t\"./menu/view/\": [\n\t\t57,\n\t\t9,\n\t\t6\n\t],\n\t\"./menu/view/components\": [\n\t\t20,\n\t\t9,\n\t\t7\n\t],\n\t\"./menu/view/components/\": [\n\t\t20,\n\t\t9,\n\t\t7\n\t],\n\t\"./menu/view/components/index\": [\n\t\t20,\n\t\t9,\n\t\t7\n\t],\n\t\"./menu/view/components/index.scss\": [\n\t\t46,\n\t\t7,\n\t\t28\n\t],\n\t\"./menu/view/components/index.tsx\": [\n\t\t20,\n\t\t9,\n\t\t7\n\t],\n\t\"./menu/view/index\": [\n\t\t57,\n\t\t9,\n\t\t6\n\t],\n\t\"./menu/view/index.ts\": [\n\t\t57,\n\t\t9,\n\t\t6\n\t],\n\t\"./menu/view/resources/reset.svg\": [\n\t\t45,\n\t\t9,\n\t\t35\n\t],\n\t\"./menu/view/resources/run.svg\": [\n\t\t43,\n\t\t9,\n\t\t36\n\t],\n\t\"./menu/view/resources/stop.svg\": [\n\t\t44,\n\t\t9,\n\t\t37\n\t],\n\t\"./painter\": [\n\t\t71,\n\t\t9,\n\t\t0,\n\t\t2,\n\t\t14\n\t],\n\t\"./painter/\": [\n\t\t71,\n\t\t9,\n\t\t0,\n\t\t2,\n\t\t14\n\t],\n\t\"./painter/@types/index.d\": [\n\t\t99,\n\t\t9,\n\t\t17\n\t],\n\t\"./painter/@types/index.d.ts\": [\n\t\t99,\n\t\t9,\n\t\t17\n\t],\n\t\"./painter/core/sketchP5\": [\n\t\t69,\n\t\t9,\n\t\t0,\n\t\t18\n\t],\n\t\"./painter/core/sketchP5.ts\": [\n\t\t69,\n\t\t9,\n\t\t0,\n\t\t18\n\t],\n\t\"./painter/core/utils\": [\n\t\t70,\n\t\t9,\n\t\t19\n\t],\n\t\"./painter/core/utils.ts\": [\n\t\t70,\n\t\t9,\n\t\t19\n\t],\n\t\"./painter/index\": [\n\t\t71,\n\t\t9,\n\t\t0,\n\t\t2,\n\t\t14\n\t],\n\t\"./painter/index.ts\": [\n\t\t71,\n\t\t9,\n\t\t0,\n\t\t2,\n\t\t14\n\t],\n\t\"./painter/painter\": [\n\t\t72,\n\t\t9,\n\t\t0,\n\t\t2\n\t],\n\t\"./painter/painter.ts\": [\n\t\t72,\n\t\t9,\n\t\t0,\n\t\t2\n\t],\n\t\"./painter/view\": [\n\t\t47,\n\t\t9,\n\t\t0,\n\t\t8\n\t],\n\t\"./painter/view/\": [\n\t\t47,\n\t\t9,\n\t\t0,\n\t\t8\n\t],\n\t\"./painter/view/components\": [\n\t\t29,\n\t\t9,\n\t\t0,\n\t\t11\n\t],\n\t\"./painter/view/components/\": [\n\t\t29,\n\t\t9,\n\t\t0,\n\t\t11\n\t],\n\t\"./painter/view/components/index\": [\n\t\t29,\n\t\t9,\n\t\t0,\n\t\t11\n\t],\n\t\"./painter/view/components/index.scss\": [\n\t\t48,\n\t\t7,\n\t\t29\n\t],\n\t\"./painter/view/components/index.tsx\": [\n\t\t29,\n\t\t9,\n\t\t0,\n\t\t11\n\t],\n\t\"./painter/view/components/utils/background\": [\n\t\t30,\n\t\t9,\n\t\t0,\n\t\t20\n\t],\n\t\"./painter/view/components/utils/background.ts\": [\n\t\t30,\n\t\t9,\n\t\t0,\n\t\t20\n\t],\n\t\"./painter/view/index\": [\n\t\t47,\n\t\t9,\n\t\t0,\n\t\t8\n\t],\n\t\"./painter/view/index.ts\": [\n\t\t47,\n\t\t9,\n\t\t0,\n\t\t8\n\t],\n\t\"./painter/view/resources/mouse.svg\": [\n\t\t50,\n\t\t9,\n\t\t38\n\t],\n\t\"./painter/view/sprite\": [\n\t\t49,\n\t\t9,\n\t\t16\n\t],\n\t\"./painter/view/sprite.ts\": [\n\t\t49,\n\t\t9,\n\t\t16\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(2).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__.t(id, ids[1])\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 119;\nmodule.exports = webpackAsyncContext;","import { IConfig, IComponent } from '../@types';\n\nimport {\n    registerElementSpecificationEntries,\n    librarySpecification,\n} from '@sugarlabs/musicblocks-v4-lib';\n\n// -- private variables ----------------------------------------------------------------------------\n\n/** File name of the selected config file. */\nconst _configFile = 'base';\n\n/** Object mapping mounted component names to the  */\nconst _components: { [name: string]: IComponent } = {};\n\n// -- private functions ----------------------------------------------------------------------------\n\n/**\n * Serializes components by dependency ordering using Topological Sorting.\n * @param config loaded config\n * @returns config with serialized components\n */\nexport function _serializeComponentDependencies(config: IConfig): IConfig {\n    const components = config.components;\n\n    const length = components.length;\n\n    /**\n     * Generates a Directed Acyclic Graph (DAG) of the component indices.\n     * @returns a `nxn` matrix representing the DAG in adjacent list form\n     *\n     * @description\n     * Consider there are five components (`a`, `b`, `c`, `d`, `e`). `b` is child of `a`, `c` is\n     * child of `b`, `e` is child of `b` and `d`.\n     * The DAG will be:\n     * a <-- b <-- c\n     *       ^\n     *       |\n     * d <-- e\n     * The DAG matrix returned will be:\n     *   ____a_____b_____c_____d_____e____\n     * a | false false false false false |\n     * b |  true false false false false |\n     * c | false  true false false false |\n     * d | false false false false false |\n     * e | false  true false  true false |\n     *   ---------------------------------\n     * A cell (`row`, `col`) represents if component with index `row` is a child of component with\n     * index `col`.\n     */\n    const createDAG = () => {\n        const DAG = new Array<boolean[]>(length);\n\n        for (let i = 0; i < length; i++) {\n            const rowComponent = components[i];\n            DAG[i] = new Array<boolean>(length);\n            DAG[i].fill(false);\n\n            if (!('parents' in rowComponent)) continue;\n\n            for (let j = 0; j < length; j++) {\n                const colComponent = components[j];\n\n                if (rowComponent.parents!.includes(colComponent.name)) {\n                    DAG[i][j] = true;\n                }\n            }\n        }\n\n        return DAG;\n    };\n\n    const DAG = createDAG();\n\n    /**\n     * Serializes the generated DAG using Topological Sorting such that child component indices\n     * appear after their parent component indices in the ordering\n     * @returns a list of serialized indices of the DAG\n     *\n     * @description\n     * For the example above (function `createDAG` description), the result will be\n     * `[0, 3, 1, 2, 4]` representing component order [`a`, `d`, `b`, `c`, `e`].\n     */\n    const serializeDAG = () => {\n        let visited: number[] = [];\n        let visiting: number[] = [];\n        let unvisited: number[] = components.map((_, i) => i);\n\n        while (unvisited.length > 0) {\n            // find nodes with no parents\n            for (let i = 0; i < length; i++) {\n                let hasParents = false;\n\n                for (let j = 0; j < length; j++) {\n                    if (DAG[i][j] === true) {\n                        hasParents = true;\n                        break;\n                    }\n                }\n\n                // if node has no parents and node wasn't visited\n                if (!hasParents && !visited.includes(i)) {\n                    // add node to visitng list\n                    visiting.push(i);\n                    // remove node from unvisited list\n                    unvisited.splice(\n                        unvisited.findIndex((index) => index === i),\n                        1,\n                    );\n                }\n            }\n\n            // edge case for cyclic graph (or subgraph)\n            if (visiting.length === 0) {\n                throw Error('Invalid Config: dependency resolution results in a cyclic graph');\n            }\n\n            // for visiting nodes in order\n            for (const index of visiting) {\n                // add node to visited list\n                visited.push(index);\n\n                // remove all edges (in DAG) to node\n                for (let j = 0; j < length; j++) {\n                    DAG[j][index] = false;\n                }\n            }\n\n            // clear visiting list\n            visiting = [];\n        }\n\n        return visited;\n    };\n\n    const serializedIndices = serializeDAG();\n\n    return { components: serializedIndices.map((i) => components[i]) };\n}\n\n// -- public functions -----------------------------------------------------------------------------\n\n/**\n * Returns a component module by it's name.\n * @param name name of the component\n * @returns component module if valid name else `null`\n */\nexport function getComponent(name: string): IComponent | null {\n    return name in _components ? _components[name] : null;\n}\n\n// -------------------------------------------------------------------------------------------------\n\n// load the config file\n(async () => {\n    let config: IConfig;\n\n    try {\n        if (process.env['NODE_ENV'] === 'development') {\n            const configModule = await import(`./${_configFile}-dev.json`);\n            config = configModule.default;\n        } else {\n            throw Error();\n        }\n    } catch (e) {\n        const configModule = await import(`./${_configFile}.json`);\n        config = configModule.default;\n    }\n\n    let importPromises: Promise<[string, IComponent]>[] = [];\n\n    /*\n     * dummy config to debug valid topological sorting\n     *   a <-- b <-- c\n     *         ^\n     *         |\n     *   d <-- e\n     */\n\n    // _serializeComponentDependencies({\n    //     components: [\n    //         { name: 'a' },\n    //         { name: 'b', parents: ['a'] },\n    //         { name: 'c', parents: ['b'] },\n    //         { name: 'd' },\n    //         { name: 'e', parents: ['b', 'd'] },\n    //     ],\n    // }).components.forEach((component) => console.log(component.name));\n\n    /*\n     * dummy config to debug invalid (cycle in `b`, `c`, `e`) topological sorting\n     *   a <-- b <-- c\n     *         |     ^\n     *         v     |\n     *   d <-- e ----\n     */\n\n    // _serializeComponentDependencies({\n    //     components: [\n    //         { name: 'a' },\n    //         { name: 'b', parents: ['e'] },\n    //         { name: 'c', parents: ['b'] },\n    //         { name: 'd' },\n    //         { name: 'e', parents: ['d', 'c'] },\n    //     ],\n    // }).components.forEach((component) => console.log(component.name));\n\n    const configEntriesSerialized = _serializeComponentDependencies(config);\n\n    // for each component entry in the config file\n    configEntriesSerialized.components.forEach((componentEntry) => {\n        // import the component module using the component name in the component entry\n        importPromises.push(\n            import(`../components/${componentEntry.name}`).then((component: IComponent) => {\n                if ('elements' in componentEntry) {\n                    // register the syntax elements specified in the component entry from the\n                    // component module's specification\n                    if (typeof componentEntry.elements === 'boolean') {\n                        if (componentEntry.elements) {\n                            registerElementSpecificationEntries(component.specification!);\n                        }\n                    } else {\n                        registerElementSpecificationEntries(\n                            Object.fromEntries(\n                                (componentEntry.elements as string[])\n                                    .map((elementName) => [\n                                        elementName,\n                                        component.specification![elementName],\n                                    ])\n                                    .filter(([_, specification]) => specification !== undefined),\n                            ),\n                        );\n                    }\n                }\n\n                return new Promise((resolve) => {\n                    // mount the component\n                    component.mount().then(() => resolve([componentEntry.name, component]));\n                });\n            }),\n        );\n    });\n\n    Promise.all(importPromises).then((components) => {\n        registerElementSpecificationEntries(librarySpecification);\n\n        const iterator = components.entries();\n\n        const setupComponent = (\n            iteratorResult: IteratorResult<[number, [string, IComponent]], unknown>,\n        ) => {\n            if (iteratorResult.done) return;\n\n            const [_, [name, component]] = iteratorResult.value;\n            _components[name] = component;\n            // initialize the components after they are mounted\n            component.setup().then(() => setupComponent(iterator.next()));\n        };\n\n        setupComponent(iterator.next());\n    });\n})();\n"],"sourceRoot":""}